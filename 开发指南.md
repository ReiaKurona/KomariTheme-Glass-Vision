# 🛠️ Komari 液态玻璃主题开发指南

## 📁 项目结构

```
komari-liquid-glass-theme/
├── src/                     # 源代码目录
│   ├── components/          # React 组件
│   │   ├── NodeGrid.tsx         # 网格视图组件
│   │   ├── NodeCompact.tsx      # 紧凑视图组件
│   │   ├── NodeTable.tsx        # 表格视图组件
│   │   ├── NodeDetail.tsx       # 节点详情组件
│   │   ├── SettingsPanel.tsx    # 设置面板组件
│   │   ├── LoadingScreen.tsx    # 加载屏幕组件
│   │   ├── BackgroundManager.tsx    # 背景管理组件
│   │   ├── ScrollRefractionManager.tsx  # 滚动折射效果管理
│   │   ├── AppearanceManager.tsx    # 外观模式管理
│   │   ├── NetworkStatusNotification.tsx  # 网络状态通知
│   │   └── GlobalStats.tsx      # 全局统计组件
│   ├── hooks/               # 自定义 Hooks
│   │   ├── useKomariAPI.ts      # Komari API 数据管理
│   │   ├── useMobile.ts         # 移动端检测
│   │   └── useTheme.ts          # 主题管理
│   ├── contexts/            # React 上下文
│   │   └── ThemeContext.tsx     # 主题上下文
│   ├── types/               # TypeScript 类型定义
│   │   └── index.ts             # 主要类型定义
│   ├── App.tsx              # 主应用组件
│   ├── main.tsx             # 应用入口
│   └── index.css            # 全局样式
├── dist/                    # 构建输出目录（已有）
├── komari-theme.json        # 主题配置文件
├── package.json             # 项目配置
├── vite.config.ts           # Vite 配置
├── tsconfig.json            # TypeScript 配置
├── tailwind.config.js       # Tailwind CSS 配置
├── build.js                 # 生产构建脚本
├── build-dev.js             # 开发构建脚本
└── index.html               # HTML 模板
```

## 🚀 开发环境设置

### 1. 安装依赖
```bash
npm install
```

### 2. 启动开发服务器
```bash
npm run dev
```

### 3. 构建项目
```bash
# 开发构建（会回退到 dist 目录）
npm run build-dev

# 生产构建
npm run build

# 打包主题
npm run pack
```

## 🎨 主题特性

### 核心功能
- **液态玻璃效果** - 真实的 iOS 26 风格玻璃质感
- **响应式设计** - 完美适配桌面和移动端
- **多视图模式** - 网格、紧凑、表格三种展示方式
- **实时监控** - WebSocket 实时数据更新
- **主题配置** - 13个可配置选项
- **背景管理** - 桌面端和移动端分别设置背景

### 技术栈
- **React 18** - 现代 React 框架
- **TypeScript** - 类型安全
- **Vite** - 快速构建工具
- **Tailwind CSS** - 实用优先的 CSS 框架
- **Framer Motion** - 流畅动画库
- **Lucide React** - 现代图标库

## 🔧 开发说明

### API 集成
项目使用以下 Komari API：
- `GET /api/public` - 获取公开配置和主题设置
- `GET /api/nodes` - 获取节点列表
- `WebSocket /api/clients` - 实时状态数据
- `GET /api/records/load` - 历史记录数据

### 主题配置
主题配置通过 `komari-theme.json` 定义，包含：
- 外观设置（颜色、透明度、模糊度等）
- 背景设置（桌面端/移动端背景）
- 布局设置（默认视图、动画等）
- 全局统计设置

### 样式系统
- 使用 Tailwind CSS 进行样式管理
- 自定义 CSS 变量控制玻璃效果
- 响应式设计适配移动端
- 暗黑/浅色模式支持

## 📱 移动端优化

### 背景处理
- 移动端使用 `background-attachment: scroll`
- 桌面端使用 `background-attachment: fixed`
- 支持独立的移动端背景图片

### 交互优化
- 触摸友好的按钮大小
- 简化的移动端布局
- 手势支持和动画优化

## 🎯 组件开发

### 新增组件
1. 在 `src/components/` 创建组件文件
2. 使用 TypeScript 和 React Hooks
3. 遵循现有的样式约定
4. 添加适当的动画效果

### 样式约定
- 使用 `glass-card` 类创建玻璃效果
- 使用 `glass-button` 类创建按钮
- 遵循颜色主题变量
- 支持暗黑/浅色模式

### 状态管理
- 使用 React Context 管理全局状态
- 自定义 Hooks 封装业务逻辑
- 本地存储保存用户偏好

## 🔍 调试和测试

### 开发工具
- React DevTools - 组件调试
- Vite DevTools - 构建分析
- 浏览器开发者工具 - 样式调试

### 常见问题
1. **WebSocket 连接失败** - 检查 Komari 服务器状态
2. **样式不生效** - 检查 CSS 变量和类名
3. **移动端背景问题** - 检查背景附着模式
4. **动画卡顿** - 启用性能优化模式

## 📦 构建和部署

### 构建流程
1. TypeScript 编译检查
2. Vite 构建优化
3. 资源文件复制
4. 主题包压缩

### 部署步骤
1. 运行构建脚本生成 ZIP 文件
2. 登录 Komari 管理面板
3. 上传主题包
4. 启用并配置主题

## 🤝 贡献指南

### 代码规范
- 使用 TypeScript 严格模式
- 遵循 ESLint 规则
- 组件使用函数式写法
- 适当添加注释

### 提交规范
- 功能: `feat: 添加新功能`
- 修复: `fix: 修复问题`
- 样式: `style: 样式调整`
- 重构: `refactor: 代码重构`

这个项目现在有了完整的源码结构，可以进行正常的开发和维护！